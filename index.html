<!DOCTYPE html>
<html>
<head>
  <title>Absensi Otomatis Aldo</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
    }
    .log {
      margin-top: 20px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>Absensi Kehadiran Test</h1>
  <input type="text" id="inputNIS" placeholder="Masukkan NIS"><br>
  <button onclick="absenMasuk()">Masuk</button>
  <div class="log" id="log"></div>

<script>
  const webAppURL = 'https://script.google.com/macros/s/AKfycbxJYk7kkAvzeQLBib_tFE6sqfDyeI0RVebNMRAFPR0-c491rh1KMUIMI0DqSWHnykWSAw/exec';

  async function absenMasuk() {
    const input = document.getElementById("inputNIS").value.trim();
    const log = document.getElementById("log");

    if (!input) {
      log.innerText = "‚ö†Ô∏è Masukkan NIS terlebih dahulu!";
      return;
    }

    log.innerText = "üîÑ Mengirim data absensi...";

    try {
      const formData = new FormData();
      formData.append("nis", input);
      formData.append("mode", "masuk");

      const res = await fetch(webAppURL, {
        method: "POST",
        body: formData,
      });

      const text = await res.text();
      if (text === "OK") {
        const now = new Date().toLocaleString("id-ID");
        log.innerText = `‚úÖ Absensi masuk berhasil dicatat pada ${now}`;
      } else {
        log.innerText = "‚ùå Gagal mencatat absen!";
      }
    } catch (err) {
      log.innerText = "‚ö†Ô∏è Error saat mengirim data!";
      console.error(err);
    }
  }
 </script>
</body>
</html>
